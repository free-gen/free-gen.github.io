<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–æ–≤–æ–≥–æ–¥–Ω–µ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #1a1a1a;
            color: #ffffff;
            position: relative;
        }
        #clock {
            font-size: 1rem;
            font-family: monospace;
            position: fixed;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 4px;
            z-index: 1000;
            white-space: nowrap;
        }
        #videoContainer {
            max-width: 1200px;
            width: 90vw;
            aspect-ratio: 16/9;
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            display: none;
        }
        .message {
            font-size: 2rem;
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            z-index: 1;
        }
        #customControls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            display: none;
            gap: 10px;
            z-index: 2;
        }
        #muteButton, #fullscreenButton {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px 10px;
            font-size: 1.2em;
            transition: transform 0.2s;
        }
        #muteButton:hover, #fullscreenButton:hover {
            transform: scale(1.1);
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ */
        video:fullscreen {
            border-radius: 0;
        }
        #videoContainer:fullscreen {
            max-width: none;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            background: black;
        }
    </style>
</head>
<body>
    <div id="clock"></div>
    <div id="videoContainer">
        <video id="videoPlayer" autoplay playsinline preload="auto">
            <source src="video.mp4" type="video/mp4">
            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ —Ç–µ–≥.
        </video>
        <div id="message" class="message"></div>
        <div id="customControls">
            <button id="muteButton">üîá</button>
            <button id="fullscreenButton">‚õ∂</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ
            const video = document.getElementById('videoPlayer');
            video.load();
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è
            video.addEventListener('loadedmetadata', () => {
                video.currentTime = 0;
                video.pause();
            });
        });

        // –ó–∞–º–µ–Ω–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤–∏–¥–µ–æ –Ω–∞ –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é
        const videoConfig = {
            bellsTimeMinutes: 4,
            bellsTimeSeconds: 49,
            bellsTimeMillis: 500,
            targetHours: 22,
            targetMinutes: 40,
            targetSeconds: 0
        };

        // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
        const startTime = {};

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
        function calculateStartTime() {
            const now = new Date();
            const midnight = new Date(now);
            midnight.setHours(videoConfig.targetHours, videoConfig.targetMinutes, videoConfig.targetSeconds, 0);
            
            // –ï—Å–ª–∏ –ø–æ–ª–Ω–æ—á—å —É–∂–µ –ø—Ä–æ—à–ª–∞, –±–µ—Ä–µ–º —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
            if (midnight < now) {
                midnight.setDate(midnight.getDate() + 1);
            }

            // –í—ã—á–∏—Ç–∞–µ–º –≤—Ä–µ–º—è –¥–æ –∫—É—Ä–∞–Ω—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ (–ø–µ—Ä–µ–≤–æ–¥–∏–º –≤—Å—ë –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã)
            const bellsStartTime = (videoConfig.bellsTimeMinutes * 60 * 1000) + 
                                 (videoConfig.bellsTimeSeconds * 1000) + 
                                 videoConfig.bellsTimeMillis;
            const startDateTime = new Date(midnight);
            startDateTime.setMilliseconds(startDateTime.getMilliseconds() - bellsStartTime);

            startTime.hours = startDateTime.getHours();
            startTime.minutes = startDateTime.getMinutes();
            startTime.seconds = startDateTime.getSeconds();
            startTime.milliseconds = startDateTime.getMilliseconds();
        }

        calculateStartTime();

        const video = document.getElementById('videoPlayer');
        const videoContainer = document.getElementById('videoContainer');
        const muteButton = document.getElementById('muteButton');
        const fullscreenButton = document.getElementById('fullscreenButton');
        const customControls = document.getElementById('customControls');

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞
        muteButton.addEventListener('click', () => {
            video.muted = !video.muted;
            muteButton.textContent = video.muted ? 'üîá' : 'üîä';
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        fullscreenButton.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                if (videoContainer.requestFullscreen) {
                    videoContainer.requestFullscreen();
                } else if (videoContainer.webkitRequestFullscreen) {
                    videoContainer.webkitRequestFullscreen();
                } else if (videoContainer.msRequestFullscreen) {
                    videoContainer.msRequestFullscreen();
                }
                fullscreenButton.textContent = '‚Æå';
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
                fullscreenButton.textContent = '‚õ∂';
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        document.addEventListener('fullscreenchange', () => {
            fullscreenButton.textContent = document.fullscreenElement ? '‚Æå' : '‚õ∂';
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        videoContainer.addEventListener('mouseenter', () => {
            customControls.style.display = 'flex';
        });

        videoContainer.addEventListener('mouseleave', () => {
            if (!document.fullscreenElement) {
                customControls.style.display = 'none';
            }
        });

        // –î–æ–±–∞–≤–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–¥–µ–æ
        let videoStarted = false;

        // –î–æ–±–∞–≤–∏–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
        function getCurrentTime() {
            const now = new Date();
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            return new Date(utc + (3600000 * 10)); // UTC+10
        }

        function updateClock() {
            const utcPlus10 = getCurrentTime();
            
            const hours = utcPlus10.getHours().toString().padStart(2, '0');
            const minutes = utcPlus10.getMinutes().toString().padStart(2, '0');
            const seconds = utcPlus10.getSeconds().toString().padStart(2, '0');
            const millis = utcPlus10.getMilliseconds().toString().padStart(3, '0');
            
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –¥–æ –ù–æ–≤–æ–≥–æ –ì–æ–¥–∞
            const newYearTime = new Date(utcPlus10);
            newYearTime.setHours(videoConfig.targetHours, videoConfig.targetMinutes, videoConfig.targetSeconds, 0);
            
            if (newYearTime < utcPlus10) {
                newYearTime.setDate(newYearTime.getDate() + 1);
            }
            
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏
            const startTime = new Date(newYearTime);
            startTime.setMinutes(startTime.getMinutes() - videoConfig.bellsTimeMinutes);
            startTime.setSeconds(startTime.getSeconds() - videoConfig.bellsTimeSeconds);
            startTime.setMilliseconds(startTime.getMilliseconds() - videoConfig.bellsTimeMillis);

            const timeToStart = startTime.getTime() - utcPlus10.getTime();
            const timeLeft = newYearTime.getTime() - utcPlus10.getTime();

            // –û–±–Ω–æ–≤–ª—è–µ–º —á–∞—Å—ã
            if (timeLeft > 0) {
                const hoursLeft = Math.floor(timeLeft / 3600000).toString().padStart(2, '0');
                const minutesLeft = Math.floor((timeLeft % 3600000) / 60000).toString().padStart(2, '0');
                const secondsLeft = Math.floor((timeLeft % 60000) / 1000).toString().padStart(2, '0');
                const millisLeft = (timeLeft % 1000).toString().padStart(3, '0');
                
                document.getElementById('clock').textContent = 
                    `${hours}:${minutes}:${seconds}.${millis} (UTC+10) | –î–æ –ù–æ–≤–æ–≥–æ –ì–æ–¥–∞: ${hoursLeft}:${minutesLeft}:${secondsLeft}.${millisLeft}`;
            }

            // –ó–∞–ø—É—Å–∫–∞–µ–º –≤–∏–¥–µ–æ —Ç–æ—á–Ω–æ –≤–æ–≤—Ä–µ–º—è
            if (!videoStarted && timeToStart <= 0 && utcPlus10.getTime() < newYearTime.getTime()) {
                videoStarted = true;
                startVideo();
            }

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            if (utcPlus10.getTime() >= newYearTime.getTime()) {
                videoStarted = false;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
            if (!videoStarted) {
                updateMessage(timeToStart);
            }
        }

        function updateMessage(timeToStart) {
            if (timeToStart > 0) {
                const hoursToStart = Math.floor(timeToStart / 3600000).toString().padStart(2, '0');
                const minutesToStart = Math.floor((timeToStart % 3600000) / 60000).toString().padStart(2, '0');
                const secondsToStart = Math.floor((timeToStart % 60000) / 1000).toString().padStart(2, '0');
                
                document.getElementById('message').textContent = 
                    `–î–æ –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏: ${hoursToStart}:${minutesToStart}:${secondsToStart}`;
            }
        }

        // –î–æ–±–∞–≤–∏–º –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function startVideo() {
            const video = document.getElementById('videoPlayer');
            video.style.display = 'block';
            document.getElementById('message').style.display = 'none';
            video.currentTime = 0;
            video.muted = false;
            
            const playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.catch(e => {
                    console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e);
                    // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
                    video.addEventListener('click', () => {
                        video.play().catch(console.error);
                    }, { once: true });
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                    videoStarted = false;
                    video.style.display = 'none';
                    document.getElementById('message').style.display = 'block';
                });
            }
        }

        function updateCountdown(currentTime) {
            const targetTime = new Date(currentTime);
            targetTime.setHours(videoConfig.targetHours, videoConfig.targetMinutes, videoConfig.targetSeconds, 0);
            
            if (targetTime < currentTime) {
                targetTime.setDate(targetTime.getDate() + 1);
            }
            
            const timeLeft = targetTime - currentTime;
            
            if (timeLeft > 0) {
                const hoursLeft = Math.floor(timeLeft / 3600000);
                const minutesLeft = Math.floor((timeLeft % 3600000) / 60000);
                const secondsLeft = Math.floor((timeLeft % 60000) / 1000);
                
                document.getElementById('message').textContent = 
                    `–î–æ –ù–æ–≤–æ–≥–æ –ì–æ–¥–∞: ${hoursLeft.toString().padStart(2, '0')}:${minutesLeft.toString().padStart(2, '0')}:${secondsLeft.toString().padStart(2, '0')}`;
            }
        }

        // –ó–∞–º–µ–Ω—è–µ–º setInterval –Ω–∞ requestAnimationFrame
        function tick() {
            updateClock();
            requestAnimationFrame(tick);
        }

        // –ó–∞–º–µ–Ω—è–µ–º setInterval –Ω–∞ requestAnimationFrame
        requestAnimationFrame(tick);
        updateClock(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Å–æ–≤

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤–∏–¥–µ–æ
        video.addEventListener('ended', () => {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            }
            video.style.display = 'none';
            document.getElementById('message').textContent = '–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! üéÑ';
            document.getElementById('message').style.display = 'block';
        });

        // –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –ø–æ—Å–ª–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è video
        video.addEventListener('loadeddata', () => {
            console.log('–í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é');
        });

        video.addEventListener('error', (e) => {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:', e);
        });
    </script>
</body>
</html> 
