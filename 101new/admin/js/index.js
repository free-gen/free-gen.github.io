!function(r){"use strict";for(var a,l,t=r.ColorPicker,n=t||r.Tools,e=document.getElementById("description").getElementsByTagName("select")[0],c=0,s=0,i=document.getElementById("testPatch"),d=document.getElementById("contrastPatch"),h=d.firstChild,u=document.getElementById("colorValues"),o=document.getElementById("color_squares"),m=o.children,g=m.length;g--;)m[g].style.backgroundColor="rgb("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+")";n.addEvent(o,"click",function(t){t=t.target||t.srcElement;t.parentNode===this&&(W.setColor(t.style.backgroundColor),Z(!0))});var v,f,b=(H=document.getElementById("sliders")).children,y=!1,p={rgb:{r:255,g:255,b:255},hsl:{h:360,s:100,l:100},cmy:{c:100,m:100,y:100},Lab:{L:100,a:256,b:256}},C=function(t){var e={};e[f]=(t.clientX-a.left)/c*p[v][f]-(y?128:0),W.setColor(e,v)};n.addEvent(H,"mousedown",function(t){var e,o=t.target||t.srcElement;o!==this&&(t.preventDefault&&t.preventDefault(),o=(e=(l=o.id?o:o.parentNode).id).length-1,v=e.substr(0,o),f=e.charAt(o),y="Lab"===v&&/(?:a|b)/.test(f),a=n.getOrigin(l),c=l.offsetWidth,C(t),n.addEvent(r,"mousemove",C),Z())}),n.addEvent(r,"mouseup",function(){n.removeEvent(r,"mousemove",C),j()});var E,k,M,B,x,R=document.getElementById("hsv_map"),G=R.children[1],I=R.children[2],L=R.children[3],w=R.children[4],N=R.children[6],S=N.className,X=N.children[0],T=N.children[1],D=(o=document.getElementById("surface")).offsetHeight/2,H=document.getElementById("luminanceBar"),P=function(t){var e,o,r,n;l===R?(n=s/2,e=t.clientX-a.left-n,o=t.clientY-a.top-n,r=360-(180*Math.atan2(o,e)/Math.PI+(o<0?360:0)),n=Math.sqrt(e*e+o*o)/n*100,W.setColor({h:r,s:n},"hsv")):l===N&&W.setColor({v:(s-(t.clientY-a.top))/s*100},"hsv")};function Y(t,e,o,r,n){var a=e[0]||e,l=e[1]||e,e=o[0]||o,o=o[1]||o,c=360,s=Math.PI/180;for(t.save(),t.translate(a-e,l-o),t.scale(e,o),r=c/r||360;0<c;c-=r)t.beginPath(),360!==r&&t.moveTo(1,1),t.arc(1,1,1,(c-r/2-1)*s,(c+r/2+1)*s),n?n(t,c):(t.fillStyle="black",t.fill());t.restore()}function A(t){var e,o,r;(e=t).RND.rgb,i.style.cssText="background-color: "+(W.color||W).toString()+";color: "+(.22<e.rgbaMixBlack.luminance?"#222":"#ddd"),i.firstChild.data="#"+e.HEX,function(t){t.RND.rgb;var e=t.background.RGB,o=W.options||W.color.options,r=(r=W?o.customBG:{})||{r:1,g:1,b:1},n=o.alphaBG,o={w:"White",b:"Black",c:"Custom"}[n];r="b"===n?{r:0,g:0,b:0}:"w"===n?{r:1,g:1,b:1}:r,d.style.cssText="background-color: rgb("+Math.round(255*r.r)+","+Math.round(255*r.g)+","+Math.round(255*r.b)+");color: "+(W.color||W).toString(),h.style.cssText="background-color: rgba("+e.r+","+e.g+","+e.b+","+t.background.alpha+");",d.children[1].firstChild.data=t["rgbaMixBGMix"+o]?"*"+t["rgbaMixBGMix"+o].WCAG2Ratio+"*":"-Test-"}(t),r=(o=t).RND,u.firstChild.data=(W.color||W).toString("rgb",!0).replace(/, /g,",")+"\nhsva("+r.hsv.h+","+r.hsv.s+","+r.hsv.v+","+o.alpha+")\n"+(W.color||W).toString("hsl",!0).replace(/, /g,",")+"\nCMYK("+r.cmyk.c+","+r.cmyk.m+","+r.cmyk.y+","+r.cmyk.k+")\nCMY("+r.cmy.c+","+r.cmy.m+","+r.cmy.y+")\nLab("+r.Lab.L+","+r.Lab.a+","+r.Lab.b+")",function(t){for(var e=b.length;e--;){var o=b[e],r=o.id.length-1,n=o.id.substr(0,r),r=o.id.charAt(r);o.children[0].style.width=t.RND[n][r]/p[n][r]*100+("Lab"===n&&/(?:a|b)/.test(r)?50:0)+"%"}}(t),e=t,o=2*Math.PI,r=Math.cos(o-e.hsv.h*o),t=Math.sin(o-e.hsv.h*o),o=e.hsv.s*(D-5),G.style.opacity=1-e.hsv.v,w.style.opacity=1-e.hsv.s,L.style.backgroundColor="rgb("+e.hueRGB.r+","+e.hueRGB.g+","+e.hueRGB.b+")",I.style.cssText="left: "+(r*o+D)+"px;top: "+(t*o+D)+"px;border-color: "+(.22<e.RGBLuminance?"#333;":"#ddd"),N.className=.22<e.RGBLuminance?S+" dark":S,X&&(X.style.top=T.style.top=(1-e.hsv.v)*D*2+"px")}n.addEvent(R,"mousedown",function(t){var e=t.target||t.srcElement;t.preventDefault&&t.preventDefault(),l=e.id?e:e.parentNode,a=n.getOrigin(l),s=l.offsetHeight,n.addEvent(r,"mousemove",P),R.className="no-cursor",P(t),Z()}),n.addEvent(r,"mouseup",function(){n.removeEvent(r,"mousemove",P),R.className="",j()}),o.getContext&&(Y(o.getContext("2d"),[o.width/2,o.height/2],[o.width/2-1,o.height/2-1],360,function(t,e){var o=t.createRadialGradient(1,1,1,1,1,0);o.addColorStop(0,"hsl("+(360-e)+", 100%, 50%)"),o.addColorStop(1,"#FFFFFF"),t.fillStyle=o,t.fill()}),E=o.getContext("2d"),k=[o.width/2,o.height/2],M=[o.width/2,o.height/2],B="#555",x=(x=3)||1,M=[(M[0]||M)-x/2,(M[1]||M)-x/2],Y(E,k,M,1,function(t,e){t.restore(),t.lineWidth=x,t.strokeStyle=B||"#000",t.stroke()}),(H=(o=H.getContext("2d")).createLinearGradient(0,0,0,200)).addColorStop(0,"transparent"),H.addColorStop(1,"black"),o.fillStyle=H,o.fillRect(0,0,30,200));var F,W,Z=function(t){U?W.startRender(t):t?A(W.colors):F=r.setInterval(function(){A(W.colors)},13)},j=function(){U?W.stopRender():r.clearInterval(F)},q=new(t||Colors)({customBG:"#808080",imagePath:"images/"}),O=new Colors,U="ColorPicker"===e.value;W=r.myColor=O,U||A(W.colors),e.onchange=function(t){"Colors"===this.value?(q.color.options.renderCallback=function(t){},W=r.myColor=O,U=!1,A(W.colors)):(q.color.options.renderCallback=A,W=r.myColor=q,U=!0,A(W.color.colors))},r.conversionTest=function(t){t&&console.time("convertAll");for(var e,o,r,n,a=(W.color||W).convertColor,l=["hsl","hsv","rgb","cmy","cmyk","Lab","XYZ","HEX"],c={},s=0,i=[],d=[],h=2;h--;)for(var u=0,m=l.length;u<m;u++){"HEX"===l[u]?c="89ABCD":(c={},n="Lab"===l[u],c[l[u][0]]=h&&!n?.85:Math.round(85)+(n?.85:0),c[l[u][1]]=h&&!n?.33:Math.round(33)+(n?.33:0),c[l[u][2]]=h&&!n?.23:Math.round(23)+(n?.23:0),"cmyk"===l[u]&&(c[l[u][3]]=h?.1:Math.round(10))),e=h?l[u]:l[u].toUpperCase();for(var g=2;g--;)for(var v=0,f=l.length;v<f;v++)if(o=g?l[v]:l[v].toUpperCase(),e!==o&&!(!g&&/(?:XYZ|HEX)/.test(o)||!h&&/(?:XYZ|HEX)/.test(e))){if(r=a(c,e+"2"+o),!t){for(var b in i=[],c)i.push(b+": "+c[b]);for(var b in i="HEX"===e?'"'+c+'"':"{"+i.join(", ")+"}",d=[],r)d.push(b+": "+r[b]);d="HEX"===o?'"'+r+'"':"{"+d.join(", ")+"}",console.log("convertColor("+i+', "'+e+"2"+o+'") = '+d)}s++}}console.log("Tested "+s+" conversion combinations (excluding same to same)"),t||console.log("Call conversionTest(true) for timer (incl. calculations in for loops though...)"),t&&console.timeEnd("convertAll")}}(window);